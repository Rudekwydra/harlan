var REGEX_TRIBUNAL=/SELECT\s+FROM\s+'([^']*)'\.'([^']*)'/i,REGEX_SIGLA=/\'sigla\'\s*=\s*'([^']*)'/i,REGEX_PARAMETER=/\'(numero_oab|processo|)\'\s*=\s*'([^']*)'/i;harlan.trigger("projuris::init"),harlan.interface.instance.logo.empty().append($("<div />").addClass("logo-projuris")),harlan.interface.addCSSDocument("css/projuris.min.css"),$(".scroll-down .actions").hide(),$("#input-q").attr({placeholder:"Qual processo você esta procurando?",value:harlan.serverCommunication.apiKey,disabled:"disabled"}),harlan.registerCall("loader::catchElement",function(){return[]}),$("title").text("Projuris | Processos Jurídicos Acompanhados no Sistema"),$("link[rel='shortcut icon']").attr("href","images/favicon-projuris.png"),harlan.serverCommunication.call("SELECT FROM 'PUSHJURISTEK'.'REPORT'",harlan.call("loader::ajax",{success:function(a){var t=harlan.call("section")("Processos Cadastrados","Processos jurídicos acompanhados no sistema","Créditos disponíveis e extrato"),e=$(a),r=harlan.call("generateResult");r.addItem("Usuário",e.find("BPQL > body > username").text());var s=parseInt(e.find("BPQL > body > limit").text()),o=parseInt(e.find("BPQL > body > total").text()),d=o/s*100;console.log("Ainda restam para o usuário: "+d.toString()),(1/0==d||isNaN(d))&&(d=0),r.addItem("Créditos Contratados",numeral(s).format("0,")).addClass("center"),r.addItem("Créditos Utlizados",numeral(o).format("0,")).addClass("center");var n=harlan.interface.widgets.radialProject(r.addItem(null,"").addClass("center").find(".value"),d);d>.8?n.addClass("warning animated flash"):d>.6&&n.addClass("attention animated flash"),r.addItem().append($("<input />").addClass("submit").attr({type:"submit",value:"Comprar mais Créditos"})).click(function(a){a.preventDefault(),window.location.href="http://www.projuris.com.br/"});var i=e.find("BPQL > body push");i.length&&(r.addSeparator("Extrato de Processos","Processos Realizados",1===i.length?"1 processo":i.length.toString()+" processos"),i.each(function(a,t){var e=$(t),s=harlan.call("generateResult");s.addItem("Título",e.attr("label")),s.addItem("Versão",e.attr("version")||"0").addClass("center"),s.addItem("Criação",moment(e.attr("created")).format("L")).addClass("center").addClass("center"),s.addItem("Atualização",moment(e.attr("nextJob")).fromNow());var o=e.find("data").text().match(REGEX_SIGLA);o&&s.addItem("Sigla",o[1]);var d=e.find("data").text().match(REGEX_TRIBUNAL);d&&s.addItem(d[1],d[2]).css("width","20%");var n=e.find("data").text().match(REGEX_PARAMETER);n&&s.addItem(n[1],n[2]),r.generate().append(s.generate().addClass("table"))})),t[1].append(r.generate()),$(".app-content").append(t[0])}}));